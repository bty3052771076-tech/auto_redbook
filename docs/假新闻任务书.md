# 假新闻任务书（每日假新闻）

## 目标
在现有“标题 + 简略提示词（可选）+ 图片（可选）→ 生成草稿并保存”的基础上，新增一条**特殊标题触发的娱乐化工作流**：

- 当标题精确为 **`每日假新闻`** 时：
  1) 仅调用 LLM，**基于简略提示词**生成一条“幽默、夸张、明显虚构”的新闻  
  2) 生成结构化草稿（title/body/topics）并保存到草稿箱  
  3) 后续流程保持不变（校验、Playwright 保存草稿）

> 核心要求：内容必须明确为娱乐/虚构语气，避免与真实新闻混淆。

## 触发条件
- `title` 精确匹配：`每日假新闻`（去除首尾空白）

## 工作流行为（详细）
### 1) 生成假新闻内容（LLM）
- 输入：`prompt`（简略提示词，用户给定）
- LLM 指令重点：
  - 明确为虚构/娱乐口吻（幽默、夸张、轻松）
  - 不引用真实新闻来源/链接，不提供真实数据或可验证事实
  - 不涉及真实人物的恶意编造或指控
  - 仅输出可直接发布的正文，不复述提示词/规则
- 输出结构：`{title, body, topics}`
  - `title`：≤ 20 字，由 LLM 改写为简洁标题
  - `body`：直接可发布的正文（遵循全局字数与格式约束）
  - `topics`：需包含 `每日假新闻`

### 2) 无提示词处理（fallback）
- 若 `prompt` 为空：使用默认主题（如“离谱日常/夸张科技/荒诞生活”）生成一条假新闻

### 3) 结果落盘与可追溯
- 在 `data/posts/<post_id>/post.json` 写入：
  - `platform.fake_news`: `{prompt_hint, tone="humor", is_fiction=true}`

## 配置项（环境变量）
暂无新增硬性配置。可后续扩展：
- `FAKE_NEWS_TONE`：调整语气（humor/satire）

## 使用示例
```powershell
# 一键流程：每日假新闻（带提示词）
python -m apps.cli auto --title "每日假新闻" --prompt "火星快递、外卖延迟" --assets-glob "assets/pics/*" --login-hold 60

# 只生成并落盘（不跑浏览器）
python -m apps.cli create --title "每日假新闻" --prompt "会飞的地铁" --assets-glob "assets/pics/*"
```

## 验收标准
- 输入 `--title "每日假新闻"` 时，生成草稿为明显虚构的娱乐内容
- `title` ≤ 20 字，`body` 仅包含可发布正文，不含提示词/规则
- `topics` 含 `每日假新闻`
- 成功保存到草稿箱

## 任务拆解与进度（待确认后执行）
## 任务拆解与进度（滚动更新）
- [x] 增加“每日假新闻”分支（title 精确匹配）
- [x] 设计假新闻专用 prompt（幽默、虚构、明确不与现实混淆）
- [x] 落盘 `platform.fake_news` 元数据
- [x] 追加免责声明兜底：若正文未包含“本文纯属虚构，仅供娱乐。”则自动补齐
- [x] 单测：标题触发、内容格式、topics 包含
- [ ] README 补充：新增功能与示例命令

## 最近测试记录
- 2026-01-06：`auto --title "每日假新闻" --prompt "吕布和董卓是一对苦命鸳鸯"` 保存草稿成功；正文未出现免责声明，已在代码中补齐兜底。
- 2026-01-06（回归）：再次运行同命令，草稿保存成功，正文末尾已包含“本文纯属虚构，仅供娱乐。”。
