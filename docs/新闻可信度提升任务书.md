# 新闻可信度提升任务书

## 背景
用户反馈“新闻的信源不可靠”。当前“每日新闻”流程会从 NewsAPI/GDELT 拉取候选并按相关性排序，但未对来源做可信度筛选或权重控制，导致偶发低质量来源被选中。

## 现状概览（基于当前程序）
- Provider：NewsAPI（有 key 时优先）/ GDELT（无 key 回退）。
- 选择策略：按提示词相关性排序，标题命中权重更高；未引入来源可信度过滤。
- 元数据：落盘包含 provider/query/candidates/picked 等，但缺少可信度字段与来源白名单机制。

## 目标与验收标准
- 引入“来源可信度”策略：可配置、可回退、可审计。
- 选中新闻需来自可信来源列表或通过可信度评分阈值。
- 元数据记录来源与可信度评分，便于追踪与复核。
- 在严格模式下无候选时，能安全回退（降级）并给出提示。

## 建议方案
### 1) 来源白名单/黑名单（最短路径）
- 增加 `NEWS_SOURCE_ALLOWLIST` / `NEWS_SOURCE_BLOCKLIST`（域名或来源名）。
- 对 NewsAPI 直接传 `sources` 或本地过滤 domain/source。
- 对 GDELT 只能本地过滤 domain。

### 2) 可信度评分（中期）
引入来源评分表（可写在本地配置文件）：
- 评分维度：主流媒体、权威机构、专业媒体、未知/低质量来源。
- 评分用于排序加权和阈值过滤：`NEWS_MIN_SOURCE_SCORE`。

### 3) 多源交叉验证（提升可靠性）
对候选新闻做“跨域名重复验证”：
- 标题相似且来自 ≥2 个不同域名则加权。
- 若只出现单一来源且评分偏低，降权或剔除。

### 4) 可见性与审阅提示（降低误用）
- `platform.news` 中记录来源、domain、评分、是否通过可信度规则。
- CLI 生成后增加一行提示：来源名称 + 域名 + 评分，方便人工复核。

## 工作项拆解
1) 来源白名单/黑名单机制
   - 支持 `NEWS_SOURCE_ALLOWLIST` / `NEWS_SOURCE_BLOCKLIST`
   - NewsAPI/GDELT 统一在本地过滤
2) 可信度评分机制
   - 本地 `docs/news_source_trust.md` 或 `data/config/news_source_trust.json`
   - 新增 `NEWS_MIN_SOURCE_SCORE`，低于阈值的候选剔除或降权
3) 交叉验证策略
   - 标题相似度聚类（同题多源）
   - 多源一致性加权
4) 元数据与审阅提示
   - `platform.news` 增加 `source_score` / `source_passed` 字段
   - CLI 输出增加来源与评分提醒

## 验收清单
- 当配置白名单时，选中新闻来源必须在白名单内。
- 当配置评分阈值时，低于阈值的候选不会被选中。
- 元数据能追溯来源与评分；人工审批时可快速识别低可信来源。
- 在严格模式无候选时，能回退到默认策略并提示用户风险。

## 风险与注意事项
- 过严的过滤会导致无候选或相关性降低。
- 部分领域（小众话题）可用来源较少，需要合理回退策略。

## 进度跟踪
当前状态：任务已创建，待确认采用方案与实现优先级。
最新进展：已在候选新闻选择中加入跨域名重复验证加权，并在每日新闻正文末尾追加来源与网址。
